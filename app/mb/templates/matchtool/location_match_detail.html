{% extends "mb/base_generic.html" %}
{% block title %}
<title>MammalBase - {{ sourceLocation }}</title>
{% endblock %}
{% block content %} {% load custom_tags %}
<!--Article header -->
<header style="display:none">
  <h1>MammalBase - {{ sourceLocation }}</h1>
</header>
<!--End of article header -->
<section class="w3-threequarter w3-container">
  <header class="w3-container w3-text-teal">
    <h2>Location Match</h2>
    <form method="POST">
      {% csrf_token %}
      <label>Refine Search:</label>
      <input type="text" id="search" name="query" value="{{ sourceLocation }}">
      <input type="submit" value="Submit">
    </form>
  </header>


    {% if request.user|is_data_admin_or_contributor %}
      <br>
      <br>
    {% endif %}
    <table class="mb-list w3-table-all w3-small w3-responsive">
      <thead>
        <tr>
          <th>Name</th>
          <th>ID</th>
        </tr>
      </thead>
      <tbody>
        {% for location in result_locations %}
        <tr>
          {% if location.name %}
            <td>{{ location.name }}</td>
          {% else %}
            <td style="text-align:center">-</td>
          {% endif %}
          {% if location.geonameId %}
            <td><a href="https://www.geonames.org/{{ location.geonameId }}">{{ location.geonameId }}</a></td>
          {% else %}
            <td style="text-align:center">-</td>
          {% endif %}
            <td><button onclick="executePythonFunction('{{ location.geonameId }}', '{{ sourceLocation }}')">Match</button>

                <script>
                    function executePythonFunction(geoNamesLocation, sourceLocation) {
                        window.location.href = `/match_location/?geoNamesLocation=${geoNamesLocation}&sourceLocation=${sourceLocation}`
                    }
                </script></td>
          
        </tr>
        {% endfor %}
      </tbody>
    </table>
 
  </section>
{% endblock %}

{% block script %}
{% endblock %}
